<!DOCTYPE HTML>
<!--
	Miniport by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Preprocessing Phase</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<link rel="stylesheet" href="assets/css/prism.css" />
	</head>
	<body class="is-preload">

		<!-- Nav -->
			<nav id="nav">
				<ul class="container">
					<li><a href="index.html">Home</a></li>
					<li><a href="#top">Data Preprocessing</a></li>
				</ul>
			</nav>

			<!-- Header -->
			<article class="wrapper style1 compact">
				<header>
					<h2>Data Preprocessing</h2>
					<p>This section details how the team preprocessed the data gathered during the <b>data collection</b> phase.</p>
				</header>
				<div class="col-12">
					<section class="box style3 compact desc">
						<h3>Outline</h3>
							<ol class="outline" style="list-style-type:upper-roman">
								<li><a href="#missing-values">Handling missing values</a></li>
								<li><a href="#format-consistency">Format Consistency</a></li>
								<li>
									Handling Outliers
									<ol style="list-style-type:upper-alpha">
										<li><a href="#examine-distribution">Examining the Distribution</a></li>
										<li><a href="#detecting-outliers">Detecting Outliers</a></li>
										<li><a href="#imputing-outliers">Imputing the Outliers</a></li>
									</ol>
								</li>
								<li><a href="#normalization">Normalization</a></li>
							</ol>
					</section>
				</div>
			</article>
		
			<!-- Content -->
			<article class="wrapper style2 compact">
				<div class="container">
					<div class="row aln-center">
						<div id="missing-values" class="col-12">
							<section class="box style4 desc">
								<h3>Handling missing values</h3>
									The stark majority of preprocessing was performed using Deepnote as the collaboration platform. <br>
									The first step involves cleaning up the raw data which contained columns unnecessary for
									data analyses.
							</section>
						</div>
						<div class="col-12">
							<section class="box style5">
<pre>
<code class="language-python">
	import pandas as pd

	path = "Dataset - Group 40 - Data.csv"
	raw_data = pd.read_csv(path, header=0)

	# Drop empty entries
	dengvaxia_data = raw_data.drop("ID", axis=1)  # Drop early to help in dropping rows
	dengvaxia_data.dropna(how="all", inplace=True)

	# Drop unnecessary features
	dengvaxia_data.drop([
				"Timestamp",
				"Tweet URL",
				"Group",
				"Collector",
				"Category",
				"Topic",
				"Keywords",
				"Account handle",
				"Account name",
				"Account bio",
				"Location",
				"Tweet Translated",
				"Screenshot",
				"Quote Tweets",
				"Views",
				"Reasoning",
				"Remarks",
				"Add columns here",
				"Add columns here.1",
				"Add columns here.2",
				"Reviewer",
				"Review",
				], axis=1, inplace=True,)

	list(dengvaxia_data)	
</code> 
</pre>
							</section>
						</div>
						<div class="col-12">
							<section class="box style5">
<pre>
<code class="compact">
	['Account type',
	'Joined',
	'Following',
	'Followers',
	'Tweet',
	'Tweet Type',
	'Date posted',
	'Content type',
	'Likes',
	'Replies',
	'Retweets',
	'Rating']
</code>
</pre>
							</section>
						</div>
						<div class="col-12">
							<section class="box style6 desc">
								We then checked for missing values in each of the columns. <br>
								The only one with missing data was the <b>Account type</b> column. This was fixed by simply
								filling the missing value with 'Anonymous'
							</section>
						</div>
						<div class="col-12">
							<section class="box style5">
<pre>
<code class="language-python">
	# Prints out missing values
	for i in dengvaxia_data.columns:
	print("Number of missing data in", i + ":", dengvaxia_data[i].isnull().sum())

	# Fill missing Account Type entries with 'Anonymous'
	dengvaxia_data["Account type"].fillna("Anonymous", inplace=True)
</code> 
</pre>
							</section>
						</div>
						<div class="col-12">
							<section class="box style5">
<pre>
<code class="compact">
	<label style="color: red">Number of missing data in Account type: 1</label>
	Number of missing data in Joined: 0
	Number of missing data in Following: 0
	Number of missing data in Followers: 0
	Number of missing data in Tweet: 0
	Number of missing data in Tweet Type: 0
	Number of missing data in Date posted: 0
	Number of missing data in Content type: 0
	Number of missing data in Likes: 0
	Number of missing data in Replies: 0
	Number of missing data in Retweets: 0
	Number of missing data in Rating: 0
</code>
</pre>
							</section>
						</div>
						<div id="format-consistency" class="col-12">
							<section class="box style4 desc">
								<h3>Format Consistency</h3>
									We then performed <b>data validation</b> by ensuring that every entry in each column has the
									correct data type. <br>
									This involved converting all the date strings into <b>datetimes</b> and all the numerical counts
									into <b>integers</b>.
							</section>
						</div>
						<div class="col-12">
							<section class="box style5">
<pre>
<code class="language-python">
	# DF to store formatted data
	dengvaxia_formatted = dengvaxia_data.copy()

	# Convert dates to datetime
	dengvaxia_formatted["Joined"] = pd.to_datetime(dengvaxia_formatted["Joined"], format="%m/%y")
	dengvaxia_formatted["Date posted"] = pd.to_datetime(dengvaxia_formatted["Date posted"], format="%d/%m/%y %H:%M",
			errors="coerce").fillna(pd.to_datetime(dengvaxia_formatted["Date posted"], format="%d/%m/%Y %H:%M", errors="coerce"))
	
	# Convert floats to ints
	dengvaxia_formatted["Following"] = dengvaxia_formatted["Following"].astype(int)
	dengvaxia_formatted["Followers"] = dengvaxia_formatted["Followers"].astype(int)
	dengvaxia_formatted["Likes"] = dengvaxia_formatted["Likes"].astype(int)
	dengvaxia_formatted["Replies"] = dengvaxia_formatted["Replies"].astype(int)
	dengvaxia_formatted["Retweets"] = dengvaxia_formatted["Retweets"].astype(int)
	
	# Display changes
	changes = pd.DataFrame(
		{
			"Old datatype": dengvaxia_data.dtypes,
			"New datatype": dengvaxia_formatted.dtypes,
		}
	)
	changes.style.set_properties(**{"text-align": "left"})
</code> 
</pre>
							</section>
						</div>
						<div class="col-12">
							<section class="box style5">
								<img src="images/1_format_results.png" alt="" class="result"/>
							</section>
						</div>
						<div id="examine-distribution" class="col-12">
							<section class="box style4 desc">
								<h3>Handling Outliers: Examining the Distribution</h3>
								We decided to handle outliers for the columns <b>'Likes', 'Replies', 'Retweets', 'Following', 'Followers',
								and 'Date posted',</b> as outliers from these columns will most likely skew the dataset during the modeling phase. <br><br>

								Recall that we can detect outliers using <b>Z-scores</b> or <b>Interquartile Range (IQR)</b>. <br>
								Z-scores, however are only effective on normally distributed data while IQR works well for skewed data. 
								Hence, it is important to first visualize the distributions for the aforementioned columns.
								The code block below plots the data of each column to a <b>histogram</b>.
							</section>
						</div>
						<div class="col-12">
							<section class="box style5">
<pre>
<code class="language-python">
	import seaborn as sns
	import matplotlib.pyplot as plt
	
	sns.set_theme()
	
	# Displays histogram of a column
	def check_dist_col(column):
			plt.figure(figsize=(16, 5))
			plt.subplot(2, 1, 1)
			sns.histplot(dengvaxia_formatted[column], kde=True)
	
			plt.show()
	
	# Displays histogram of a column using their index
	def check_dist(i):
			plt.figure(figsize=(16, 5))
			plt.subplot(2, 3, i + 1)
			sns.histplot(dengvaxia_formatted[columns[i]], kde=True)
	
			plt.show()
	
	# Display histograms for the aforementioned columns
	columns = ["Likes", "Replies", "Retweets", "Following", "Followers", "Date posted"]
	for i in range(len(columns)):
			check_dist(i)
</code> 
</pre>
							</section>
						</div>
						<div class="col-12">
							<section class="box style5">
								<div class="grid-container">
									<img src="images/2a_likes_before.png" alt="" class="result"/>
									<img src="images/2b_replies_before.png" alt="" class="result"/>
									<img src="images/2c_retweets_before.png" alt="" class="result"/>
									<img src="images/2d_following_before.png" alt="" class="result"/>
									<img src="images/2e_followers_before.png" alt="" class="result"/>
									<img src="images/2f_datePosted_before.png" alt="" class="result"/>
								</div>
							</section>
						</div>
						<div class="col-12">
							<section class="box style6 desc">
								Here we observe that <b>most of the columns are skewed to the left</b>, and not normally distributed.
								For this reason, we must perform <b>IQR</b> for detecting outliers. <br>
								Before that, however, there seems to be a blank histogram for the <b>'Followers'</b> column.
								Let's take a closer look using the describe() function.
							</section>
						</div>
						<div class="col-12">
							<section class="box style5">
<pre>
<code class="language-python">
	dengvaxia_formatted["Followers"].describe()
</code> 
</pre>
							</section>
						</div>
						<div class="col-12">
							<section class="box style5">
<pre>
<code class="compact">
	count    1.500000e+02
	<label style="color: black">mean     6.739463e+04</label>
	<label style="color: red">std      7.299880e+05</label>
	<label style="color: black">min      0.000000e+00</label>
	25%      2.307500e+02
	50%      9.985000e+02
	75%      3.543750e+03
	<label style="color: red">max      8.944169e+06</label>
	Name: Followers, dtype: float64
</code>
</pre>
							</section>
						</div>
						<div class="col-12">
							<section class="box style6 desc">
								This means that for the 'Followers' column: <br>
								<ol>
									<li>The minimum value is 0 followers</li>
									<li>The maximum value is <label style="color: red">8944169 followers!</label></li>
									<li>A mean of 67394 but a <label style="color: red">standard devation of 729988!</label></li>
								</ol>
								The account with 8944169 followers <b>severely skewed the data</b> as the other values are relatively extremely small, 
								causing the histogram for 'Followers' column to be seemingly blank. The gap between the maximum value and the rest is extremely huge. <br>  <br>
								We will take a look at this again when we finally handle the outliers.
							</section>
						</div>
						<div id="detecting-outliers" class="col-12">
							<section class="box style4 desc">
								<h3>Handling Outliers: Detecting Outliers</h3>
									Recall that in box plots, any data point outside its whiskers, i.e. 1.5 times the interquartile range 
									above the upper quartile and below the lower quartile <b>(Q1 - 1.5 * IQR or Q3 + 1.5 * IQR)</b>, is an outlier. <br>

									For easier execution of detecting outliers for different categories, we create a function that takes in a column of the dataset as its parameter.
							</section>
						</div>
						<div class="col-12">
							<section class="box style5">
<pre>
<code class="language-python">
	import matplotlib.pyplot as plt
	import seaborn as sns
	import numpy as np
	import plotly.express as px
	
	def visualize_outlier(column):
			# Display boxplot
			sns.boxplot(dengvaxia_formatted, y=column, orient="v").set(xlabel=None, ylabel=column)
	
			# Find q1 and q3 values
			q1, q3 = np.percentile(sorted(dengvaxia_formatted[column]), [25, 75])
			print(f"Lower quartile (Q1): {q1}")
			print(f"Higher quartile (Q3): {q3}")
	
			# Compute IRQ
			iqr = q3 - q1
			print(f"IQR: {iqr}")
	
			# Find lower and upper bounds
			lower_bound = q1 - (1.5 * iqr)
			upper_bound = q3 + (1.5 * iqr)
	
			outliers = [x for x in dengvaxia_formatted[column] if x <= lower_bound or x >= upper_bound]
	
			# Display results
			print(f"Outliers: {outliers}")
			print(f"Number of outliers: {len(outliers)}")
			return outliers
</code> 
</pre>
							</section>
						</div>
						<div class="col-12">
							<section class="box style6 desc">
								<h3>Outliers for 'Likes'</h3>
							</section>
						</div>
						<div class="col-12">
							<section class="box style5">
<pre>
<code class="language-python">
	likes_outliers = visualize_outlier("Likes")
</code> 
</pre>
							</section>
						</div>
						<div class="col-12">
							<section class="box style5">
<pre>
<code class="compact">
	Lower quartile (Q1): 2.0
	Higher quartile (Q3): 22.75
	IQR: 20.75
	<label style="color: black">Outliers: [63, 365, 64, 54, 114, 65, 79, 95, 69, 228, 67, 88, 55, 71]</label>
	<label style="color: green">Number of outliers: 14</label>
</code>
</pre>
								<img src="images/3a_likes_outliers.png" alt="" class="result"/>
							</section>
						</div>
						<div class="col-12">
							<section class="box style6 desc">
								There are <b><label style="color: green">14 outliers</label></b> in 'Likes', which are the tweets with 
								<b><label style="color: black">63, 365, 64, 54, 114, 65, 79, 95, 69, 228, 67, 88, 55, and 71 likes</label></b>. <br><br><br>

								<h3>Outliers for 'Replies'</h3>
							</section>
						</div>
						<div class="col-12">
							<section class="box style5">
<pre>
<code class="language-python">
	replies_outliers = visualize_outlier("Replies")
</code> 
</pre>
							</section>
						</div>
						<div class="col-12">
							<section class="box style5">
<pre>
<code class="compact">
	Lower quartile (Q1): 0.0
	Higher quartile (Q3): 2.0
	IQR: 2.0
	<label style="color: black">Outliers: [18, 5, 6, 6, 18, 15, 9, 12, 5, 6, 8, 5]</label>
	<label style="color: green">Number of outliers: 12</label>
</code>
</pre>
								<img src="images/3b_replies_outliers.png" alt="" class="result"/>
							</section>
						</div>
						<div class="col-12">
							<section class="box style6 desc">
								There are <b><label style="color: green">12 outliers</label></b> in 'Replies', which are the tweets with 
								<b><label style="color: black">18, 5, 6, 6, 18, 15, 9, 12, 5, 6, 8, and 5 replies</label></b>. <br><br><br>

								<h3>And so on...</h3>
								The following is a compilation of the outliers detected from the columns <b>'Retweets', 'Following', and 'Followers'</b>.
							</section>
						</div>
						<div class="col-12">
							<section class="box style5">
<pre>
<code class="language-python">
	retweets_outliers = visualize_outlier("Retweets")
	following_outliers = visualize_outlier("Following")
	followers_outliers = visualize_outlier("Followers")
</code> 
</pre>
							</section>
						</div>
						<div class="col-12">
							<section class="box style5">
<pre>
<code class="compact">
	<b># IQR result for 'Retweets'</b>
	Lower quartile (Q1): 0.0
	Higher quartile (Q3): 8.75
	IQR: 8.75
	<label style="color: black">Outliers: [24, 118, 39, 38, 84, 31, 31, 42, 27, 50, 25, 31, 23, 29]</label>
	<label style="color: green">Number of outliers: 14</label>
</code>
</pre>
								<img src="images/3c_retweets_outliers.png" alt="" class="result"/>
<pre>
<code class="compact">	
	<b># IQR result for 'Following'</b>
	Lower quartile (Q1): 357.0
	Higher quartile (Q3): 1995.0
	IQR: 1638.0
	<label style="color: black">Outliers: [4998, 4703, 9380, 4874, 15211, 5895, 4995, 4980, 5895, 4572, 4871, 11780, 5655, 23135]</label>
	<label style="color: green">Number of outliers: 14</label>
</code>
</pre>
								<img src="images/3d_following_outliers.png" alt="" class="result"/>
<pre>
<code class="compact">	
	<b># IQR result for 'Followers'</b>
	Lower quartile (Q1): 230.75
	Higher quartile (Q3): 3543.75
	IQR: 3313.0
	<label style="color: black">Outliers: [128160, 21916, 21091, 10215, 10471, 72669, 13796, 30149, 65400, 70287, 21613, 161352, 13884, 28791, 8944169, 23248, 28790, 
		       60461, 13757, 118917, 8556, 28790, 23253, 25194]</label>
	<label style="color: green">Number of outliers: 24</label>
</code>
</pre>
								<img src="images/3e_followers_outliers.png" alt="" class="result"/>
							</section>
						</div>
						<div class="col-12">
							<section class="box style6 desc">
								<h3>Outliers for 'Date posted'</h3>
								Since datetime formats cannot be easily visualized using box plots, we just manually calculate for the
								quartiles and the outliers <br>
							</section>
						</div>
						<div class="col-12">
							<section class="box style5">
<pre>
<code class="language-python">
	# Find q1 and q3 values
	q1, q3 = np.percentile(sorted(dengvaxia_formatted["Date posted"]), [25, 75])
	print(f"Lower quartile (Q1): {q1}")
	print(f"Higher quartile (Q3): {q3}")
	
	# Compute IRQ
	iqr = q3 - q1
	print(f"IQR: {iqr}")
	
	# Find lower and upper bounds
	lower_bound = q1 - (1.5 * iqr)
	upper_bound = q3 + (1.5 * iqr)
	
	date_outliers = [x for x in dengvaxia_formatted["Date posted"] if x <= lower_bound or x >= upper_bound]
	
	print(f"Outliers: {date_outliers}")
	print(f"Number of outliers: {len(date_outliers)}")
	
</code> 
</pre>
							</section>
						</div>
						<div class="col-12">
							<section class="box style5">
<pre>
<code class="compact">
	Lower quartile (Q1): 2018-09-23 14:01:00
	Higher quartile (Q3): 2021-06-12 18:30:30
	IQR: 993 days 04:29:30
	<label style="color: black">Outliers: []</label>
	<label style="color: green">Number of outliers: 0</label>
</code>
</pre>
							</section>
						</div>
						<div class="col-12">
							<section class="box style6 desc">
								There are <b>no outliers</b> for 'Date posted'. This means that we no longer need to handle outliers for this column.
							</section>
						</div>
						<div id="imputing-outliers" class="col-12">
							<section class="box style4 desc">
								<h3>Handling Outliers: Imputing the Outliers</h3>
									There are many ways to deal with outliers. In this project, since most of the columns are heavily skewed, 
									and there are outliers that have an immense gap from the rest of the data, we decided that the best way to deal
									with these outliers is by <b>imputing them with the median</b> of that column. This is because medians 
									are robust against, and are not easily affected by outliers. <br><br>

									With that, we now perform replacing the outliers for the aforementioned columns with the exception of 'Date posted'.
							</section>
						</div>
						<div class="col-12">
							<section class="box style5">
<pre>
<code class="language-python">
	# Impute outliers for 'Likes'
	for outlier in likes_outliers:
		dengvaxia_formatted["Likes"] = dengvaxia_formatted["Likes"].replace(
				outlier, np.median(dengvaxia_formatted["Likes"]))
	
	# Impute outliers for 'Replies'
	for outlier in replies_outliers:
		dengvaxia_formatted["Replies"] = dengvaxia_formatted["Replies"].replace(
				outlier, np.median(dengvaxia_formatted["Replies"]))
	
	# Impute outliers for 'Followers'
	for outlier in retweets_outliers:
		dengvaxia_formatted["Retweets"] = dengvaxia_formatted["Retweets"].replace(
				outlier, np.median(dengvaxia_formatted["Retweets"]))

	# Impute outliers for 'Followers'
	for outlier in following_outliers:
		dengvaxia_formatted["Following"] = dengvaxia_formatted["Following"].replace(
				outlier, np.median(dengvaxia_formatted["Following"]))
	
	# Impute outliers for 'Followers'
	for outlier in followers_outliers:
		dengvaxia_formatted["Followers"] = dengvaxia_formatted["Followers"].replace(
				outlier, np.median(dengvaxia_formatted["Followers"]))
	
	# Display updated histograms
	columns = ["Likes", "Replies", "Retweets", "Following", "Followers"]
	for i in range(len(columns)):
		check_dist(i)
</code> 
</pre>
							</section>
						</div>
						<div class="col-12">
							<section class="box style5">
								<div class="grid-container">
									<img src="images/4a_likes_after.png" alt="" class="result"/>
									<img src="images/4b_replies_after.png" alt="" class="result"/>
									<img src="images/4c_retweets_after.png" alt="" class="result"/>
									<img src="images/4d_following_after.png" alt="" class="result"/>
									<img src="images/4e_followers_after.png" alt="" class="result"/>
								</div>
							</section>
						</div>
						<div id="normalization" class="col-12">
							<section class="box style4 desc">
								<h3>Normalization</h3>
									Now that outliers have been dealth with, normalizing the data for these columns will now result to a more feasible and justifiable model.<br>
									This was done using sklearn's <b>MinMaxScaler</b>.
							</section>
						</div>
						div ends here
					</div>
				</div>
			</article>

		<!-- Team -->
			<article id="team" class="wrapper style4">
				<div class="container medium">
					<header>
						<h2>We'd like to hear from you.</h2>
						<p>You can add more information about the team members here.</p>
					</header>
					<div class="row">
						<div class="col-12">
							<form method="post" action="#">
								<div class="row">
									<div class="col-6 col-12-small">
										<input type="text" name="name" id="name" placeholder="Name" />
									</div>
									<div class="col-6 col-12-small">
										<input type="text" name="email" id="email" placeholder="Email" />
									</div>
									<div class="col-12">
										<input type="text" name="subject" id="subject" placeholder="Subject" />
									</div>
									<div class="col-12">
										<textarea name="message" id="message" placeholder="Message"></textarea>
									</div>
									<div class="col-12">
										<ul class="actions">
											<li><input type="submit" value="Send Message" /></li>
											<li><input type="reset" value="Clear Form" class="alt" /></li>
										</ul>
									</div>
								</div>
							</form>
						</div>
						<div class="col-12">
							<hr />
							<h3>Find me on ...</h3>
							<ul class="social">
								<li><a href="#" class="icon brands fa-twitter"><span class="label">Twitter</span></a></li>
								<li><a href="#" class="icon brands fa-facebook-f"><span class="label">Facebook</span></a></li>
								<li><a href="#" class="icon brands fa-dribbble"><span class="label">Dribbble</span></a></li>
								<li><a href="#" class="icon brands fa-linkedin-in"><span class="label">LinkedIn</span></a></li>
								<li><a href="#" class="icon brands fa-tumblr"><span class="label">Tumblr</span></a></li>
								<li><a href="#" class="icon brands fa-google-plus"><span class="label">Google+</span></a></li>
								<li><a href="#" class="icon brands fa-github"><span class="label">Github</span></a></li>
								<!--
								<li><a href="#" class="icon solid fa-rss"><span>RSS</span></a></li>
								<li><a href="#" class="icon brands fa-instagram"><span>Instagram</span></a></li>
								<li><a href="#" class="icon brands fa-foursquare"><span>Foursquare</span></a></li>
								<li><a href="#" class="icon brands fa-skype"><span>Skype</span></a></li>
								<li><a href="#" class="icon brands fa-soundcloud"><span>Soundcloud</span></a></li>
								<li><a href="#" class="icon brands fa-youtube"><span>YouTube</span></a></li>
								<li><a href="#" class="icon brands fa-blogger"><span>Blogger</span></a></li>
								<li><a href="#" class="icon brands fa-flickr"><span>Flickr</span></a></li>
								<li><a href="#" class="icon brands fa-vimeo"><span>Vimeo</span></a></li>
								-->
							</ul>
							<hr />
						</div>
					</div>
					<footer>
						<ul id="copyright">
							<li>&copy; Untitled. All rights reserved.</li><li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
						</ul>
					</footer>
				</div>
			</article>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>
			<script src="assets/js/prism.js"></script>
	</body>
</html>
